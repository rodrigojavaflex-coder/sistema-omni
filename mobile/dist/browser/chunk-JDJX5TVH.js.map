{
  "version": 3,
  "sources": ["src/app/pages/vistoria/vistoria-finalizar.page.ts", "src/app/pages/vistoria/vistoria-finalizar.page.html"],
  "sourcesContent": ["import { Component, OnInit, inject } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { NgIf } from '@angular/common';\r\nimport {\r\n  AlertController,\r\n  IonButton,\r\n  IonContent,\r\n  IonHeader,\r\n  IonItem,\r\n  IonLabel,\r\n  IonButtons,\r\n  IonMenuButton,\r\n  IonSpinner,\r\n  IonText,\r\n  IonTextarea,\r\n  IonTitle,\r\n  IonToolbar,\r\n} from '@ionic/angular/standalone';\r\nimport { Router } from '@angular/router';\r\nimport { Capacitor } from '@capacitor/core';\r\nimport { VistoriaFlowService } from '../../services/vistoria-flow.service';\r\nimport { VistoriaService } from '../../services/vistoria.service';\r\n\r\n@Component({\r\n  selector: 'app-vistoria-finalizar',\r\n  standalone: true,\r\n  templateUrl: './vistoria-finalizar.page.html',\r\n  styleUrls: ['./vistoria-finalizar.page.scss'],\r\n  imports: [\r\n    NgIf,\r\n    FormsModule,\r\n    IonContent,\r\n    IonHeader,\r\n    IonTitle,\r\n    IonToolbar,\r\n    IonButtons,\r\n    IonMenuButton,\r\n    IonItem,\r\n    IonLabel,\r\n    IonTextarea,\r\n    IonButton,\r\n    IonSpinner,\r\n    IonText,\r\n  ],\r\n})\r\nexport class VistoriaFinalizarPage implements OnInit {\r\n  private flowService = inject(VistoriaFlowService);\r\n  private vistoriaService = inject(VistoriaService);\r\n  private router = inject(Router);\r\n  private alertController = inject(AlertController);\r\n\r\n  observacao = '';\r\n  tempoMinutos = 0;\r\n  isSaving = false;\r\n  errorMessage = '';\r\n  isNative = Capacitor.getPlatform() !== 'web';\r\n\r\n  ngOnInit(): void {\r\n    this.tempoMinutos = this.flowService.getTempoEmMinutos();\r\n  }\r\n\r\n  async finalizar(): Promise<void> {\r\n    const vistoriaId = this.flowService.getVistoriaId();\r\n    if (!vistoriaId) {\r\n      this.router.navigate(['/vistoria/inicio']);\r\n      return;\r\n    }\r\n\r\n    this.isSaving = true;\r\n    this.errorMessage = '';\r\n    try {\r\n      await this.vistoriaService.finalizarVistoria(vistoriaId, {\r\n        tempo: this.tempoMinutos,\r\n        observacao: this.observacao?.trim() || undefined,\r\n      });\r\n      this.flowService.finalizar();\r\n      this.router.navigate(['/home']);\r\n    } catch (error: any) {\r\n      this.errorMessage = error?.message || 'Erro ao finalizar vistoria.';\r\n    } finally {\r\n      this.isSaving = false;\r\n    }\r\n  }\r\n\r\n  async cancelarVistoria(): Promise<void> {\r\n    const vistoriaId = this.flowService.getVistoriaId();\r\n    if (!vistoriaId) {\r\n      return;\r\n    }\r\n    const alert = await this.alertController.create({\r\n      header: 'Cancelar vistoria?',\r\n      message: 'Os itens já registrados serão mantidos como cancelados.',\r\n      buttons: [\r\n        { text: 'Voltar', role: 'cancel' },\r\n        {\r\n          text: 'Cancelar vistoria',\r\n          role: 'destructive',\r\n          handler: async () => {\r\n            await this.vistoriaService.cancelarVistoria(vistoriaId);\r\n            this.flowService.finalizar();\r\n            this.router.navigate(['/home']);\r\n          },\r\n        },\r\n      ],\r\n    });\r\n    await alert.present();\r\n  }\r\n}\r\n", "<ion-header [translucent]=\"true\">\r\n  <ion-toolbar>\r\n    <ion-buttons slot=\"start\" *ngIf=\"isNative\">\r\n      <ion-menu-button></ion-menu-button>\r\n    </ion-buttons>\r\n    <ion-title>Finalizar Vistoria</ion-title>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button color=\"danger\" (click)=\"cancelarVistoria()\">Cancelar</ion-button>\r\n    </ion-buttons>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content [fullscreen]=\"true\">\r\n  <div class=\"content\">\r\n    <ion-item>\r\n      <ion-label position=\"stacked\">Tempo total (minutos)</ion-label>\r\n      <ion-text>{{ tempoMinutos }}</ion-text>\r\n    </ion-item>\r\n\r\n    <ion-item>\r\n      <ion-label position=\"stacked\">Observação geral</ion-label>\r\n      <ion-textarea\r\n        [(ngModel)]=\"observacao\"\r\n        placeholder=\"Observação opcional\"\r\n      ></ion-textarea>\r\n    </ion-item>\r\n\r\n    <ion-text color=\"danger\" *ngIf=\"errorMessage\">\r\n      <p class=\"error-message\">{{ errorMessage }}</p>\r\n    </ion-text>\r\n\r\n    <ion-button expand=\"block\" [disabled]=\"isSaving\" (click)=\"finalizar()\">\r\n      <ion-spinner *ngIf=\"isSaving\" name=\"crescent\"></ion-spinner>\r\n      <span *ngIf=\"!isSaving\">Finalizar vistoria</span>\r\n    </ion-button>\r\n  </div>\r\n</ion-content>\r\n"],
  "mappings": "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",
  "names": []
}
