<div class="multi-select-container" appClickOutside (clickOutside)="closeDropdown()">
  <button 
    type="button"
    class="multi-select-button"
    (click)="toggleDropdown()"
    [attr.aria-expanded]="isOpen"
  >
    <span class="multi-select-label">{{ getDisplayValue() }}</span>
    <svg 
      class="dropdown-icon" 
      [class.open]="isOpen"
      xmlns="http://www.w3.org/2000/svg" 
      width="16" 
      height="16" 
      fill="currentColor" 
      viewBox="0 0 16 16"
    >
      <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
    </svg>
  </button>

  @if (isOpen) {
    <div class="multi-select-dropdown">
      <div class="dropdown-options">
        @for (option of options; track option) {
          <label class="option-item">
            <input 
              type="checkbox"
              [checked]="isSelected(option)"
              (change)="toggleItem(option)"
            >
            <span>{{ option }}</span>
          </label>
        }
        @if (options.length === 0) {
          <div class="no-options">Nenhuma opção disponível</div>
        }
      </div>

      @if (selectedItems.length > 0) {
        <div class="dropdown-footer">
          <span class="selected-count">
            {{ selectedItems.length }} selecionado(s)
          </span>
          <button 
            type="button"
            class="clear-btn"
            (click)="clearSelection()"
            title="Limpar seleção"
          >
            Limpar
          </button>
        </div>
      }
    </div>
  }
</div>
