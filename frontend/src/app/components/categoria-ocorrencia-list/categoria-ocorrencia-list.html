<div class="list-container">
  <div class="list-header">
    <h2>Categoria da Ocorrência</h2>
    <div class="header-actions">
      <button *ngIf="canCreate" class="btn btn-primary" (click)="onNew()">
        Nova Categoria
      </button>
    </div>
  </div>

  <div class="filters">
    <input
      type="text"
      [(ngModel)]="filterDescricao"
      (input)="onFilterChange()"
      placeholder="Filtrar por descrição ou origem..."
      class="filter-input"
    />
    <button (click)="clearFilters()" class="btn btn-secondary">Limpar</button>
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Carregando...</p>
  </div>

  <div *ngIf="error" class="error-container">
    <p>{{ error }}</p>
  </div>

  <div *ngIf="!loading && !error" class="table-container">
    <table class="data-table">
      <thead>
        <tr>
          <th>Descrição</th>
          <th>Origem</th>
          <th>Responsável</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of items">
          <td>{{ item.descricao }}</td>
          <td>{{ getOrigemDescricao(item) }}</td>
          <td>{{ item.responsavel || '-' }}</td>
          <td>
            <div class="table-actions">
              <button *ngIf="canEdit" class="btn btn-small btn-primary" (click)="onEdit(item)">
                Editar
              </button>
              <button *ngIf="canDelete" class="btn btn-small btn-danger" (click)="onDelete(item)">
                Excluir
              </button>
            </div>
          </td>
        </tr>
        <tr *ngIf="items.length === 0">
          <td colspan="4" class="table-empty-cell" style="text-align: center; padding: 2rem;">
            Nenhuma categoria encontrada
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<app-confirmation-modal
  [isVisible]="showDeleteModal"
  [message]="deleteModalMessage"
  (confirmed)="onDeleteConfirmed()"
  (cancelled)="onDeleteCancelled()"
></app-confirmation-modal>
